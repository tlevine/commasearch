#!/usr/bin/env python3
import argparse
from collections import namedtuple

from pluplusch import pluplusch

import commasearch.main

def parser():
    description = 'Index a bunch of data tables from open data catalogs for comma search.'
    return argparse.ArgumentParser(description = description)

def fake_args():
    Args = namedtuple('Args', ['verbose','index','force','tables'])
    return Args(True, True, False, ['-'])

def urls():
    'Emit a bunch of urls.'
    for dataset in pluplusch(standardize = True):
        if dataset['download_url'] != None:
            yield dataset['download_url']

def main():
    parser().parse_args() # I'm doing this just so it shows help; there is no input.
    commasearch.main.comma(fake_args(), stdin = urls())

if __name__ == '__main__':
    main()
    for url in urls():
        print(url)
